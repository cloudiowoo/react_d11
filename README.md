# Drupal 11 + React å…¨æ ˆåº”ç”¨

[English](README_EN.md) | [ä¸­æ–‡](README.md)

åŸºäº Drupal 11 å’Œ React 18 æ„å»ºçš„ç°ä»£åŒ–å…¨æ ˆåº”ç”¨æ¡†æ¶ï¼Œå®ç°å†…å®¹ç®¡ç†ä¸å‰ç«¯äº¤äº’çš„æœ€ä½³å®è·µã€‚
æœ¬é¡¹ç›®çš„ React ä¸»é¢˜åŸºäº Drupal 11 é»˜è®¤æ¼”ç¤ºæ•°æ®ï¼ˆUmami é£Ÿè°±ï¼‰å®šåˆ¶å¼€å‘ï¼Œæä¾›å®Œæ•´çš„å‚è€ƒå®ç°ã€‚

## ğŸ’¡ åŠŸèƒ½ç‰¹è‰²

- **å®Œæ•´æ¼”ç¤º**ï¼šåŸºäº Drupal 11 Umami æ¼”ç¤ºæ•°æ®å¼€å‘
- **å¤šè¯­è¨€æ”¯æŒ**ï¼šæ”¯æŒè‹±æ–‡ã€ä¸­æ–‡ã€è¥¿ç­ç‰™è¯­
- **å“åº”å¼è®¾è®¡**ï¼šå®Œç¾é€‚é…ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
- **ç°ä»£åŒ–äº¤äº’**ï¼šSPA ä½“éªŒ + æœåŠ¡ç«¯æ¸²æŸ“
- **å¼€ç®±å³ç”¨**ï¼šå®‰è£…æ¼”ç¤ºæ•°æ®åå¯ç›´æ¥è¿è¡Œ
- **å…¨è‡ªåŠ¨æ„å»º**ï¼šå®¹å™¨å¯åŠ¨å³å®Œæˆå®‰è£…å¹¶å¼€å¯å®æ—¶ç¼–è¯‘

## ğŸ—ï¸ æ¶æ„æ¦‚è¿°

### æŠ€æœ¯æ ˆ
- **åç«¯**: Drupal 11 (PHP 8.4)
- **å‰ç«¯**: React 18 + Vite
- **ä¸»é¢˜**: è‡ªå®šä¹‰ React ä¸»é¢˜
- **æ•°æ®åº“**: PostgreSQL 17
- **ç¼“å­˜**: Redis (å¯é€‰)

### æ¶æ„ç‰¹ç‚¹
```
é¡¹ç›®ç»“æ„
â”œâ”€â”€ web/                        # Drupal æ ¹ç›®å½•
â”‚   â”œâ”€â”€ modules/custom/         # è‡ªå®šä¹‰æ¨¡å—
â”‚   â”‚   â””â”€â”€ react_api/         # React API æ¨¡å—
â”‚   â””â”€â”€ themes/custom/react/   # React ä¸»é¢˜
â”‚       â”œâ”€â”€ react-src/         # React æºç 
â”‚       â”œâ”€â”€ js/                # ç¼–è¯‘åçš„ JS
â”‚       â””â”€â”€ templates/         # Drupal æ¨¡æ¿
â”œâ”€â”€ docker/                    # Docker é…ç½®
â””â”€â”€ composer.json             # Drupal ä¾èµ–ç®¡ç†
```

## ğŸ¯ ä¸šåŠ¡åœºæ™¯å¯¹æ¯”

### æ­¤æ¶æ„é€‚ç”¨åœºæ™¯
- éœ€è¦å¼ºå¤§çš„å†…å®¹ç®¡ç†èƒ½åŠ› + ç°ä»£åŒ–å‰ç«¯ä½“éªŒ
- å¤æ‚çš„å†…å®¹å·¥ä½œæµ + ä¸°å¯Œçš„äº¤äº’ç•Œé¢
- å¤šè¯­è¨€ã€å¤šç«™ç‚¹ + SPA ç”¨æˆ·ä½“éªŒ
- ä¼ä¸šçº§å†…å®¹å¹³å° + æ¶ˆè´¹çº§ç”¨æˆ·ç•Œé¢

### å¯¹æ¯”ä¼ ç»Ÿæ¶æ„

| ç‰¹æ€§ | Drupal + React | çº¯ Drupal | çº¯ React |
|------|----------------|-----------|-----------|
| å†…å®¹ç®¡ç† | âœ… å¼ºå¤§ | âœ… å¼ºå¤§ | âŒ éœ€è‡ªå»º |
| å‰ç«¯ä½“éªŒ | âœ… ä¼˜ç§€ | âš ï¸ ä¸€èˆ¬ | âœ… ä¼˜ç§€ |
| å¼€å‘æ•ˆç‡ | âš ï¸ éœ€åè°ƒ | âœ… é«˜ | âœ… é«˜ |
| å¯ç»´æŠ¤æ€§ | âœ… åˆ†ç¦»æ¸…æ™° | âœ… é«˜ | âœ… é«˜ |
| SEO | âœ… æ”¯æŒ | âœ… åŸç”Ÿ | âš ï¸ éœ€ä¼˜åŒ– |

## ğŸ”— å…³é”®é›†æˆæ–‡ä»¶

### Drupal-React é›†æˆ
1. **æ¨¡å—é›†æˆ**
   ```
   web/modules/custom/react_api/
   â”œâ”€â”€ react_api.routing.yml      # API è·¯ç”±å®šä¹‰
   â””â”€â”€ src/Controller/           # API æ§åˆ¶å™¨
   ```

2. **ä¸»é¢˜é›†æˆ**
   ```
   web/themes/custom/react/
   â”œâ”€â”€ react.libraries.yml       # èµ„æºåŠ è½½é…ç½®ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰
   â”œâ”€â”€ templates/               # Drupal æ¨¡æ¿
   â””â”€â”€ react-src/              # React åº”ç”¨
   ```

3. **æ•°æ®æµ**
   - Drupal æä¾› RESTful API
   - React é€šè¿‡ ContentApiService æ¶ˆè´¹ API
   - æ”¯æŒå¤šè¯­è¨€å†…å®¹åŒæ­¥

## ğŸš€ å¿«é€Ÿå¼€å§‹

1. **ç¯å¢ƒå‡†å¤‡**
   ```bash
   # å¤åˆ¶å¹¶é…ç½® docker-compose.yml
   cp docker/docker-compose.yml.example docker/docker-compose.yml
   # æ ¹æ®éœ€è¦ä¿®æ”¹æ•°æ®åº“å¯†ç ç­‰é…ç½®

   # å¯åŠ¨æ‰€æœ‰æœåŠ¡
   # node-test-vite å®¹å™¨ä¼šè‡ªåŠ¨ï¼š
   # 1. å®‰è£… npm ä¾èµ–
   # 2. å¯åŠ¨æ–‡ä»¶ç›‘å¬
   # 3. æ£€æµ‹åˆ°æ”¹åŠ¨è‡ªåŠ¨ç¼–è¯‘
   # 4. æ›´æ–° libraries.yml
   docker-compose up -d
   ```

2. **å®‰è£… Drupal**
   ```bash
   # å®‰è£…ä¾èµ–
   composer install

   # å®‰è£… Drupalï¼ˆé€‰æ‹© Demo: Umami Food Magazine (Experimental)ï¼‰
   docker exec -it php8-4-fpm-xdebug drush site:install demo_umami \
     --db-url=pgsql://postgres:[your+db+password]@pg17:5432/[your+db] \
     --account-name=[your+name] \
     --account-pass=[your+password] \
     --site-name="Drupal 11 + React Demo" \
     -y

   # å¯ç”¨å¤šè¯­è¨€æ”¯æŒ
   docker exec -it php8-4-fpm-xdebug drush en locale -y
   docker exec -it php8-4-fpm-xdebug drush language-add zh-hans
   docker exec -it php8-4-fpm-xdebug drush language-add es
   ```

3. **å¼€å‘è‡ªåŠ¨åŒ–**
   ```bash
   # æŸ¥çœ‹ React è‡ªåŠ¨æ„å»ºçŠ¶æ€
   docker logs -f node-test-vite

   # æ‰€æœ‰ React æºç æ”¹åŠ¨ä¼šè‡ªåŠ¨ï¼š
   # - è§¦å‘é‡æ–°ç¼–è¯‘
   # - ç”Ÿæˆæ–°çš„æ–‡ä»¶ hash
   # - æ›´æ–° libraries.yml
   # - å®æ—¶é¢„è§ˆå˜æ›´

   # éœ€è¦æ—¶æ¸…é™¤ Drupal ç¼“å­˜
   docker exec -it php8-4-fpm-xdebug drush cr
   ```

## ğŸ“± æ¼”ç¤ºåŠŸèƒ½

### å·²å®ç°åŠŸèƒ½
- âœ… å“åº”å¼é¦–é¡µå±•ç¤º
- âœ… é£Ÿè°±åˆ—è¡¨ä¸è¯¦æƒ…
- âœ… æ–‡ç« åˆ—è¡¨ä¸è¯¦æƒ…
- âœ… å¤šè¯­è¨€åˆ‡æ¢
- âœ… å®æ—¶æœç´¢
- âœ… åˆ†ç±»è¿‡æ»¤
- âœ… æ ‡ç­¾äº‘å±•ç¤º

### é¡µé¢é¢„è§ˆ
- é¦–é¡µï¼š`http://local.test.d11.com/`
- é£Ÿè°±åˆ—è¡¨ï¼š`http://local.test.d11.com/recipes`
- æ–‡ç« åˆ—è¡¨ï¼š`http://local.test.d11.com/articles`
- åå°ç®¡ç†ï¼š`http://local.test.d11.com/admin`
  - ç”¨æˆ·åï¼š`your+name`
  - å¯†ç ï¼š`your+password`

## ğŸ”„ å¼€å‘å·¥ä½œæµ

### React è‡ªåŠ¨åŒ–å¼€å‘
1. **å®¹å™¨è‡ªåŠ¨åŒ–**
   - å®¹å™¨å¯åŠ¨è‡ªåŠ¨å®‰è£… npm ä¾èµ–
   - è‡ªåŠ¨å¯åŠ¨æ–‡ä»¶ç›‘å¬æœåŠ¡
   - è‡ªåŠ¨æ£€æµ‹æºç æ”¹åŠ¨
   - è‡ªåŠ¨æ‰§è¡Œç¼–è¯‘æµç¨‹

2. **ç¼–è¯‘è‡ªåŠ¨åŒ–**
   - æ”¹åŠ¨æ£€æµ‹è‡ªåŠ¨è§¦å‘æ„å»º
   - è‡ªåŠ¨ç”Ÿæˆå¸¦ hash çš„æ–‡ä»¶å
   - è‡ªåŠ¨æ›´æ–° Drupal åº“é…ç½®
   - æ”¯æŒçƒ­æ›´æ–°å’Œå®æ—¶é¢„è§ˆ

3. **è°ƒè¯•æ–¹å¼**
   - å®æ—¶æŸ¥çœ‹æ„å»ºæ—¥å¿—ï¼š`docker logs -f node-test-vite`
   - ç›‘æ§ç¼–è¯‘è¾“å‡ºï¼š`web/themes/custom/react/js/`
   - æ£€æŸ¥åº“é…ç½®ï¼š`web/themes/custom/react/react.libraries.yml`

### å¼€å‘æç¤º
- æ— éœ€æ‰‹åŠ¨è¿è¡Œ npm install
- æ— éœ€æ‰‹åŠ¨å¯åŠ¨æ„å»ºæœåŠ¡
- ä¿å­˜æ–‡ä»¶è‡ªåŠ¨è§¦å‘ç¼–è¯‘
- æµè§ˆå™¨è‡ªåŠ¨åŠ è½½æœ€æ–°ç‰ˆæœ¬

## ğŸ“š æ›´å¤šæ–‡æ¡£

- [React ä¸»é¢˜å¼€å‘æŒ‡å—](web/themes/custom/react/README-DEVELOPMENT.md)
- [Docker ç¯å¢ƒé…ç½®](docker/README.md)
- [API æ–‡æ¡£](web/modules/custom/react_api/README.md)
